import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
data = pd.read_csv('tips.csv')
ColA = np.array(data.total_bill)
ColB = np.array(data.tip)
mColA = np.mat(ColA) # mat treats array as matrix
mColB = np.mat(ColB)
m= np.shape(mColB)[1]
one = np.ones((1,m) ,dtype=int)
X= np.hstack((one.T,mColA.T))
tem=np.hstack((mColA.T))
def kernel(point,xmat, k):
m,n = np.shape(xmat)
weights = np.mat(np.eye((m)))
for j in range(m):
diff = point - X[j]
weights[j,j] = np.exp(diff*diff.T/(-2.0*k**2))
return weights
def localWeight(point,xmat,ymat,k):
wt = kernel(point,xmat,k)
W = (X.T*(wt*X)).I*(X.T*(wt*ymat.T))
return W
